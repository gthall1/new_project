<% if is_mobile? %>
    <% content_for :body_class, "leaderboard-page--mobile" %>
<% else %>
    <% content_for :body_class, "leaderboard-page" %>
<% end %>

<% @mobile_container_id = "leaderboard--#{@game.slug}" %>

<section class="leaderboard-nav">
    <a class="leaderboard-back" href="/games/<%= @game.id %>"><i class="fa fa-chevron-left back-button"></i></a>
    <h1 class="leaderboard__title">Leaderboard</h1>
    <p class="leaderboard__subtitle"><%= @game.name %></p>
</section>
<% if @game.slug == "tap-color" %>
    <div class="leaderboard__cat-wrapper">
        <div class="leaderboard__cat leaderboard__cat--3">
            <h2 class="tab-control__title js-tab--difficulty active" data-tab-cat=".js-leaderboard--easy">Easy</h2>
            <h2 class="tab-control__title js-tab--difficulty" data-tab-cat=".js-leaderboard--medium">Medium</h2>
            <h2 class="tab-control__title js-tab--difficulty" data-tab-cat=".js-leaderboard--hard">Hard</h2>
        </div>
    </div>
<% end %>

<section class="leaderboard-head">
    <h1 class="leaderboard-head__title">Leaderboard</h1>
    <p class="leaderboard-head__game"><%= @game.name %></p>
</section>

<div class="leaderboard__cat-wrapper">
    <div class="leaderboard__cat js-leaderboard__cat">
        <h2 class="tab-control__title js-tab--cat ga-tab--alltime active" data-tab-cat=".leaderboard--all-time">All-Time</h2>
        <h2 class="tab-control__title js-tab--cat ga-tab--weekly" data-tab-cat=".leaderboard--weekly">Weekly</h2>
    </div>
</div>

<% if @game.slug == 'tap-color' %>
 <div class="js-leaderboard--easy js-leaderboard-diff leaderboard-diff active">
    <h2 class="leaderboard-diff__title">EASY </h2>
    <section class="game-leaderboard">
        <div class="tab-section js-tab-section leaderboard leaderboard--all-time active">
            <% get_alltime_leaderboard({game_id: @game.id,version:1} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row leadboard--easy leadboard--easy-alltime">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>

        <div class="tab-section js-tab-section leaderboard leaderboard--weekly">
            <% get_weekly_leaderboard({game_id: @game.id,version:1} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>
    </section>
</div><!-- /.leaderboard-diff -->

 <div class="js-leaderboard--medium js-leaderboard-diff leaderboard-diff">
    <h2 class="leaderboard-diff__title">MEDIUM </h2>
    <section class="game-leaderboard">
        <div class="tab-section js-tab-section leaderboard leaderboard--all-time active">
            <% get_alltime_leaderboard({game_id: @game.id,version:2} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row ">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>

        <div class="tab-section js-tab-section leaderboard leaderboard--weekly">
            <% get_weekly_leaderboard({game_id: @game.id,version:2} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>
    </section>
</div><!-- /.leaderboard-diff -->

<div class="js-leaderboard--hard js-leaderboard-diff leaderboard-diff">
    <h2 class="leaderboard-diff__title">HARD </h2>
    <section class="game-leaderboard">
        <div class="tab-section js-tab-section leaderboard leaderboard--all-time active">
            <% get_alltime_leaderboard({game_id: @game.id,version:3} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>

        <div class="tab-section js-tab-section leaderboard leaderboard--weekly">
            <% get_weekly_leaderboard({game_id: @game.id,version:3} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>
    </section>
</div><!-- /.leaderboard-diff -->
<% else %> <!--  ********************* Normal Leaderboard *********************  -->
    <section class="game-leaderboard">
        <div class="tab-section js-tab-section leaderboard leaderboard--all-time active">
            <% get_alltime_leaderboard({game_id: @game.id} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div><!-- /.leaderboard-row -->
            <% end %>
        </div>

        <div class="tab-section js-tab-section leaderboard leaderboard--weekly">
            <% get_weekly_leaderboard({game_id: @game.id} ).each.with_index(1) do | record, rank | %>
                <div class="leaderboard-row">
                    <span class="leaderboard-rank"><%= rank %></span>
                    <span class="leaderboard-user"><%= record[0] %></span>
                    <span class="leaderboard-score"><%= record[1] %></span>
                </div>
            <% end %>
        </div>
    </section>

<% end %>

<% if Rails.env.production? %>
    <!-- GA Tracking Events -->
    <%= render 'tracking_events/tracking_leaderboard' %>
<% end %>

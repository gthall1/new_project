function CMain(e){var s,r,t,o,i,a=0,n=0,d=STATE_LOADING;this.initContainer=function(){var e=document.getElementById("canvas");s_oStage=new createjs.Stage(e),createjs.Touch.enable(s_oStage),s_bMobile=jQuery.browser.mobile,s_bMobile===!1&&s_oStage.enableMouseOver(20),s_oLevelSettings=new CLevelSettings,s_iPrevTime=(new Date).getTime(),createjs.Ticker.setFPS(35),createjs.Ticker.on("tick",this._update),(DISABLE_SOUND_MOBILE===!1||s_bMobile===!1)&&this._initSounds(),s_oSpriteLibrary=new CSpriteLibrary,r=new CPreloader,this._loadImages()},this.soundLoaded=function(){a++,a===n&&(r.unload(),this.gotoMenu())},this._initSounds=function(){createjs.Sound.initializeDefaultPlugins()&&(navigator.userAgent.indexOf("Opera")>0||navigator.userAgent.indexOf("OPR")>0?(createjs.Sound.alternateExtensions=["mp3"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/press_but.ogg","press_but"),createjs.Sound.registerSound("./sounds/win.ogg","win"),createjs.Sound.registerSound("./sounds/game_over.ogg","game_over"),createjs.Sound.registerSound("./sounds/combo.ogg","combo"),createjs.Sound.registerSound("./sounds/shot.ogg","shot"),createjs.Sound.registerSound("./sounds/soundtrack.ogg","soundtrack")):(createjs.Sound.alternateExtensions=["ogg"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/press_but.mp3","press_but"),createjs.Sound.registerSound("./sounds/win.mp3","win"),createjs.Sound.registerSound("./sounds/game_over.mp3","game_over"),createjs.Sound.registerSound("./sounds/combo.mp3","combo"),createjs.Sound.registerSound("./sounds/shot.mp3","shot"),createjs.Sound.registerSound("./sounds/soundtrack.mp3","soundtrack")),n+=6)},this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("but_bg","/assets/sorcerer/but_play_bg.png"),s_oSpriteLibrary.addSprite("but_exit","/assets/sorcerer/but_exit.png"),s_oSpriteLibrary.addSprite("bg_menu","/assets/sorcerer/bg_menu.jpg"),s_oSpriteLibrary.addSprite("audio_icon","/assets/sorcerer/audio_icon.png"),s_oSpriteLibrary.addSprite("hero","/assets/sorcerer/hero.png"),s_oSpriteLibrary.addSprite("hit_area","/assets/sorcerer/hit_area.png"),s_oSpriteLibrary.addSprite("explosion","/assets/sorcerer/explosion.png"),s_oSpriteLibrary.addSprite("msg_box","/assets/sorcerer/msg_box.png"),s_oSpriteLibrary.addSprite("extra_score","/assets/sorcerer/extra_score.png"),s_oSpriteLibrary.addSprite("end_path","/assets/sorcerer/end_path.png");for(var e=0;BALL_COLORS>e;e++)s_oSpriteLibrary.addSprite("ball_"+e,"/assets/sorcerer/ball_"+e+".png");for(var s=0;s<s_oLevelSettings.getNumLevels();s++)s_oSpriteLibrary.addSprite("bg_game_"+(s+1),"/assets/sorcerer/bg_game_"+(s+1)+".jpg");n+=s_oSpriteLibrary.getNumSprites(),s_oSpriteLibrary.loadSprites()},this._onImagesLoaded=function(){a++;var e=Math.floor(100*(a/n));r.refreshLoader(e),a===n&&(r.unload(),this.gotoMenu())},this._onAllImagesLoaded=function(){},this.onAllPreloaderImagesLoaded=function(){this._loadImages()},this.gotoMenu=function(){t=new CMenu,d=STATE_MENU},this.gotoGame=function(){i=new CGame(s),d=STATE_GAME,$(s_oMain).trigger("game_start")},this.gotoHelp=function(){o=new CHelp,d=STATE_HELP},this._update=function(e){var s=(new Date).getTime();s_iTimeElaps=s-s_iPrevTime,s_iCntTime+=s_iTimeElaps,s_iCntFps++,s_iPrevTime=s,s_iCntTime>=1e3&&(s_iCurFps=s_iCntFps,s_iCntTime-=1e3,s_iCntFps=0),d===STATE_GAME&&i.update(),void 0!==s_oStage&&s_oStage.update(e)},s_oMain=this,s=e,this.initContainer()}var s_bMobile,s_bAudioActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundtrack,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oLevelSettings;
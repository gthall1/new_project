function getRandomImageForTile(){for(var e=Math.floor(Math.random()*tileAllocation.length),i=2;tileAllocation[e]>=i;)e+=1,e>=tileAllocation.length&&(e=0);return e}function createTile(e){var i=new tile("tile"+e),l=getRandomImageForTile();return tileAllocation[l]=tileAllocation[l]+1,i.setFrontColor("tileColor"+Math.floor(5*Math.random()+1)),i.setStartAt(500*Math.floor(5*Math.random()+1)),i.setFlipMethod(flips[Math.floor(3*Math.random()+1)]),i.setBackContentImage("/assets/"+(l+1)+".jpg"),i}function initState(){for(tileAllocation=new Array(0,0,0,0,0,0,0,0,0,0);tiles.length>0;)tiles.pop();$("#board").empty(),iTimer=0}function initTiles(){var e=0,i=null;for(initState(),e=0;20>e;e++)i=createTile(e),$("#board").append(i.getHTML()),tiles.push(i)}function hideTiles(e){var i=0;for(i=0;i<tiles.length;i++)tiles[i].revertFlip();e()}function revealTiles(e){var i=0,l=!1;for(i=0;i<tiles.length;i++)tiles[i].getFlipped()===!1&&(iTimer>tiles[i].getStartAt()?tiles[i].flip():l=!0);iTimer+=iInterval,l===!0?setTimeout("revealTiles("+e+")",iInterval):e()}function playAudio(e){var i=document.getElementById("audioEngine");null!==i&&(i.src=e,i.play())}function checkMatch(){null===iFlippedTile?iFlippedTile=iTileBeingFlippedId:(tiles[iFlippedTile].getBackContentImage()!==tiles[iTileBeingFlippedId].getBackContentImage()?(setTimeout("tiles["+iFlippedTile+"].revertFlip()",2e3),setTimeout("tiles["+iTileBeingFlippedId+"].revertFlip()",2e3),playAudio("mp3/no.mp3")):playAudio("mp3/applause.mp3"),iFlippedTile=null,iTileBeingFlippedId=null)}function onPeekComplete(){$("div.tile").click(function(){iTileBeingFlippedId=this.id.substring("tile".length),tiles[iTileBeingFlippedId].getFlipped()===!1&&(tiles[iTileBeingFlippedId].addFlipCompleteCallback(function(){checkMatch()}),tiles[iTileBeingFlippedId].flip())})}function onPeekStart(){setTimeout("hideTiles( function() { onPeekComplete(); })",iPeekTime)}var tiles=new Array,flips=new Array("tb","bt","lr","rl"),iFlippedTile=null,iTileBeingFlippedId=null,tileImages=new Array(1,2,3,4,5,6,7,8,9,10),tileAllocation=null,iTimer=0,iInterval=100,iPeekTime=3e3;$(document).ready(function(){$("#startGameButton").click(function(){initTiles(),setTimeout("revealTiles(function() { onPeekStart(); })",iInterval)})});